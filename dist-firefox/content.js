!function(){"use strict";const t="ytTabFS",e="yt-tabfs-enabled",n="yt-tabfs-button";function o(t,e=5e3,n=50){return new Promise((o,c)=>{const i=Date.now(),a=()=>{const r=t();r?o(r):Date.now()-i>e?c(new Error("Timeout waiting for condition")):setTimeout(a,n)};a()})}var c,i,a,r,s;function u(){const t=document.querySelector(".ytp-chrome-controls .ytp-right-controls .ytp-right-controls-left");if(t&&l(t))return t;const e=[".ytp-chrome-controls .ytp-right-controls",".ytp-right-controls","#movie_player .ytp-chrome-controls .ytp-right-controls",".html5-video-player .ytp-chrome-controls .ytp-right-controls"];for(const t of e){const e=document.querySelector(t);if(e&&l(e))return e}return null}function l(t){return t&&t.offsetWidth>0&&t.offsetHeight>0}!function(e){e.getState=function(){try{return"1"===sessionStorage.getItem(t)}catch{return!1}},e.setState=function(e){try{e?sessionStorage.setItem(t,"1"):sessionStorage.removeItem(t)}catch{}}}(c||(c={})),function(t){t.enable=function(){document.documentElement.classList.add(e)},t.disable=function(){document.documentElement.classList.remove(e)},t.isEnabled=function(){return document.documentElement.classList.contains(e)}}(i||(i={})),function(t){let e=null;function o(){document.querySelectorAll(`#${n}`).forEach(t=>t.remove()),e=null}function a(t){t.preventDefault(),t.stopPropagation();const e=!c.getState();e?i.enable():i.disable(),c.setState(e),r(e)}function r(t){e&&(t?(e.classList.add("active"),e.setAttribute("aria-pressed","true")):(e.classList.remove("active"),e.setAttribute("aria-pressed","false")))}t.cleanup=o,t.create=function(){o();const t=document.createElement("button");t.id=n,t.className="ytp-button playerButton",t.setAttribute("title","Tab Fullscreen (Alt+T)");const c=document.createElement("img");return c.id=n+"Image",c.className="playerButtonImage",c.src="data:image/svg+xml;base64,"+btoa('\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24">\n        <path fill="white" d="M 6 2.5 L 18 2.5 C 18.55 2.5 19 2.95 19 3.5 C 19 4.05 18.55 4.5 18 4.5 L 6 4.5 C 5.45 4.5 5 4.05 5 3.5 C 5 2.95 5.45 2.5 6 2.5 Z M 3 5 L 21 5 C 22.10 5 23 5.90 23 7 L 23 19 C 23 20.10 22.10 21 21 21 L 3 21 C 1.90 21 1 20.10 1 19 L 1 7 C 1 5.90 1.90 5 3 5 Z M 3 7 L 3 19 L 21 19 L 21 7 L 3 7 Z M 12 9 L 14.29 11.29 C 14.68 11.68 14.68 12.31 14.29 12.70 C 13.90 13.09 13.27 13.09 12.88 12.70 L 12 11.83 L 11.12 12.70 C 10.73 13.09 10.10 13.09 9.71 12.70 C 9.32 12.31 9.32 11.68 9.71 11.29 L 12 9 Z M 12 15 L 9.71 12.71 C 9.32 12.32 9.32 11.69 9.71 11.30 C 10.10 10.91 10.73 10.91 11.12 11.30 L 12 12.17 L 12.88 11.30 C 13.27 10.91 13.90 10.91 14.29 11.30 C 14.68 11.69 14.68 12.32 14.29 12.71 L 12 15 Z M 9 12 L 6.71 9.71 C 6.32 9.32 5.69 9.32 5.30 9.71 C 4.91 10.10 4.91 10.73 5.30 11.12 L 6.17 12 L 5.30 12.88 C 4.91 13.27 4.91 13.90 5.30 14.29 C 5.69 14.68 6.32 14.68 6.71 14.29 L 9 12 Z M 15 12 L 17.29 14.29 C 17.68 14.68 18.31 14.68 18.70 14.29 C 19.09 13.90 19.09 13.27 18.70 12.88 L 17.83 12 L 18.70 11.12 C 19.09 10.73 19.09 10.10 18.70 9.71 C 18.31 9.32 17.68 9.32 17.29 9.71 L 15 12 Z"/>\n      </svg>\n    '),t.appendChild(c),t.addEventListener("click",a),e=t,t},t.updateButtonState=r,t.getButton=function(){return e}}(a||(a={})),function(t){let e=!1;t.inject=function(){try{const t=document.getElementById(n);if(e&&t&&t.isConnected)return!0;const o=u();if(!o)return!1;a.cleanup();const i=a.create();if(!i)return!1;const r=c.getState();a.updateButtonState(r);try{o.prepend(i);const t=document.getElementById(n);return!(!t||!t.isConnected)&&(e=!0,!0)}catch(t){return!1}}catch(t){return!1}},t.reset=function(){a.cleanup(),e=!1}}(r||(r={})),function(t){function e(){if(!window.location.pathname.includes("/watch"))return;const t=a.getButton();if(t)t.click();else if(r.inject()){const t=a.getButton();t&&t.click()}}t.init=function(){("undefined"!=typeof browser&&browser?browser:chrome).runtime.onMessage.addListener((t,n,o)=>("toggle-tabfs"===t.action&&(e(),o({success:!0})),!0)),document.addEventListener("keydown",t=>{if(t.altKey&&"t"===t.key.toLowerCase()&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey)return t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e(),!1},{capture:!0}),window.addEventListener("keydown",t=>{if(t.altKey&&"t"===t.key.toLowerCase()&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey)return t.preventDefault(),t.stopPropagation(),e(),!1},{capture:!0})}}(s||(s={}));let d=null;function m(){return new URLSearchParams(window.location.search).get("v")}function f(){const t=m();t!==d&&(d=t,r.reset(),t&&y())}async function y(){const t=await async function(){try{await o(()=>!!document.querySelector("video"),1e4,100);let t=null;for(let e=0;e<3;e++)try{if(t=await o(()=>u(),5e3,100),t)break}catch(t){await new Promise(t=>setTimeout(t,1e3))}return!!t}catch(t){return!1}}();if(!t)return setTimeout(()=>y(),1e3),void setTimeout(()=>y(),5e3);let e=!1;const n=[0,100,500,1e3,2e3];for(const t of n)if(t>0&&await new Promise(e=>setTimeout(e,t)),e=r.inject(),e)break;c.getState()&&(i.enable(),a.updateButtonState(!0))}async function h(){s.init(),!window.location.pathname.includes("/watch")&&i.isEnabled()&&(i.disable(),c.setState(!1)),window.location.pathname.includes("/watch")&&(d=m(),await y());let t=location.href;new MutationObserver(()=>{const e=location.href;e!==t&&(t=e,f())}).observe(document,{subtree:!0,childList:!0}),setInterval(f,1e3);let e=null;new MutationObserver(()=>{window.location.pathname.includes("/watch")&&!document.getElementById(n)&&(e&&clearTimeout(e),e=setTimeout(()=>{u()&&!document.getElementById(n)&&r.inject()},100))}).observe(document.body,{childList:!0,subtree:!0})}s.init(),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{h().catch(t=>{})}):h().catch(t=>{setTimeout(()=>h(),1e3)}),setTimeout(()=>{document.getElementById(n)||h().catch(t=>{})},100);(()=>{const t=()=>{const e=document.getElementById("movie_player");e&&e.classList.contains("html5-video-player")?!document.getElementById(n)&&window.location.pathname.includes("/watch")&&y():setTimeout(t,500)};t()})();(()=>{const t=()=>{const e=document.querySelector(".ytp-chrome-controls .ytp-right-controls .ytp-right-controls-left");e&&!document.getElementById(n)&&window.location.pathname.includes("/watch")?r.inject():e||setTimeout(t,200)};setTimeout(t,1e3)})(),document.addEventListener("yt-navigate-finish",()=>{f()}),document.addEventListener("yt-player-updated",()=>{window.location.pathname.includes("/watch")&&!document.getElementById(n)&&y()}),window.addEventListener("load",()=>{setTimeout(()=>{window.location.pathname.includes("/watch")&&!document.getElementById(n)&&y()},500)})}();
