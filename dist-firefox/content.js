!function(){"use strict";const t="ytTabFS",e="yt-tabfs-enabled",n="yt-tabfs-button";var o,i,c,r,a,s,l,u;async function d(){if(!window.location.pathname.includes("/watch"))return;if(await l.waitForPlayer()){if(r.inject()){o.getState()&&(i.enable(),c.updateButtonState(!0))}}else setTimeout((()=>d()),1e3)}function f(){!window.location.pathname.includes("/watch")&&i.isEnabled()&&(i.disable(),o.setState(!1)),u.handleInitialLoad(),a.start(),s.init()}!function(e){e.getState=function(){try{return"1"===sessionStorage.getItem(t)}catch{return!1}},e.setState=function(e){try{e?sessionStorage.setItem(t,"1"):sessionStorage.removeItem(t)}catch{}}}(o||(o={})),function(t){t.enable=function(){document.documentElement.classList.add(e)},t.disable=function(){document.documentElement.classList.remove(e)},t.isEnabled=function(){return document.documentElement.classList.contains(e)}}(i||(i={})),function(t){let e=null;function c(){document.querySelectorAll(`#${n}`).forEach((t=>t.remove())),e=null}function r(t){t.preventDefault(),t.stopPropagation();const e=!o.getState();e?i.enable():i.disable(),o.setState(e),a(e)}function a(t){e&&(t?(e.classList.add("active"),e.setAttribute("aria-pressed","true")):(e.classList.remove("active"),e.setAttribute("aria-pressed","false")))}t.cleanup=c,t.create=function(){c();const t=document.createElement("button");return t.id=n,t.className="ytp-button",t.setAttribute("aria-label","Tab Fullscreen"),t.setAttribute("title","Tab Fullscreen (Alt+T)"),t.setAttribute("data-tooltip-opaque","false"),t.innerHTML='\n      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round" style="pointer-events: none; width: 24px; height: 24px;">\n        \x3c!-- Tab bar (browser chrome) --\x3e\n        <rect x="6" y="2.5" width="12" height="2" rx="1" ry="1" fill="currentColor" stroke="none"/>\n        \x3c!-- Video frame --\x3e\n        <rect x="3" y="5" width="18" height="16" rx="2" ry="2"/>\n        \x3c!-- Up arrow --\x3e\n        <line x1="12" y1="9" x2="12" y2="6.2"/>\n        <polyline points="10.7,7.5 12,6 13.3,7.5"/>\n        \x3c!-- Down arrow --\x3e\n        <line x1="12" y1="14.8" x2="12" y2="17.6"/>\n        <polyline points="10.7,16.3 12,17.8 13.3,16.3"/>\n        \x3c!-- Left arrow --\x3e\n        <line x1="7.2" y1="12" x2="4.4" y2="12"/>\n        <polyline points="5.9,10.7 4.4,12 5.9,13.3"/>\n        \x3c!-- Right arrow --\x3e\n        <line x1="16.8" y1="12" x2="19.6" y2="12"/>\n        <polyline points="18.1,10.7 19.6,12 18.1,13.3"/>\n      </svg>\n    ',t.addEventListener("click",r),e=t,t},t.updateButtonState=a,t.getButton=function(){return e}}(c||(c={})),function(t){let e=!1;t.inject=function(){const t=document.getElementById(n);if(e&&t)return!0;e&&!t&&(e=!1);const i=document.querySelector(".ytp-chrome-controls .ytp-left-controls");if(!i)return!1;c.cleanup();const r=c.create(),a=o.getState();c.updateButtonState(a);const s=i.querySelector(".ytp-volume-panel"),l=i.querySelector(".ytp-time-display");return l&&l.nextSibling?i.insertBefore(r,l.nextSibling):s&&s.nextSibling?i.insertBefore(r,s.nextSibling):i.appendChild(r),e=!0,!0},t.reset=function(){c.cleanup(),e=!1}}(r||(r={})),function(t){let e=null,a=null,s="",l="",u=null;function f(t,e=200){u&&clearTimeout(u),u=window.setTimeout(t,e)}function m(){a&&a.disconnect();const t=document.querySelector("#movie_player");t&&(a=new MutationObserver((t=>{if(!document.getElementById(n)&&window.location.pathname.includes("/watch")){document.querySelector(".ytp-chrome-controls .ytp-left-controls")&&f((()=>{r.reset(),r.inject()}),100)}})),a.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]}))}t.start=function(){e||(s=window.location.pathname,l=window.location.href,e=new MutationObserver((()=>{const t=window.location.pathname,e=window.location.href;if(t!==s||e!==l)if(s=t,l=e,t.includes("/watch"))f((()=>{r.reset(),d(),setTimeout((()=>m()),500)}),150);else{if(o.getState()){i.disable(),o.setState(!1);c.getButton()&&c.updateButtonState(!1)}r.reset(),a&&(a.disconnect(),a=null)}else if(t.includes("/watch")){document.getElementById(n)||f((()=>{r.reset(),d()}),150)}})),e.observe(document.body,{childList:!0,subtree:!0}),s.includes("/watch")&&setTimeout((()=>m()),500))},t.stop=function(){e&&(e.disconnect(),e=null),a&&(a.disconnect(),a=null)}}(a||(a={})),function(t){function e(){if(!window.location.pathname.includes("/watch"))return;const t=c.getButton();if(t)t.click();else if(r.inject()){const t=c.getButton();t&&t.click()}}t.init=function(){("undefined"!=typeof browser&&browser?browser:chrome).runtime.onMessage.addListener(((t,n,o)=>("toggle-tabfs"===t.action&&(e(),o({success:!0})),!0))),document.addEventListener("keydown",(t=>{t.altKey&&"t"===t.key.toLowerCase()&&(t.preventDefault(),t.stopPropagation(),e())}),!0)}}(s||(s={})),function(t){t.waitForPlayer=function(){return new Promise((t=>{let e=0;const n=()=>{const o=document.querySelector(".ytp-chrome-controls .ytp-left-controls"),i=document.querySelector("#movie_player");o&&i?t(!0):(e++,e>=100?t(!1):setTimeout(n,100))};n()}))}}(l||(l={})),function(t){let e=0;t.handleInitialLoad=function t(){window.location.pathname.includes("/watch")&&d().then((()=>{e=0})).catch((n=>{if(e<10){e++;const n=Math.min(1e3*Math.pow(2,e-1),5e3);setTimeout((()=>t()),n)}}))}}(u||(u={})),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",f):f()}();
